<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../images/logo.jpg" type="image/jpg">
    <title>عرض بيانات الدرس</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="../style/side_menu.css">
    <style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    direction: rtl;
    background: url('../images/bg.jpg') no-repeat center center fixed;
    background-size: cover;
    margin: 0;
    padding: 20px;
    color: #2c3e50; /* أصفر */
}
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* طبقة شفافة فوق الخلفية */
    backdrop-filter: blur(8px); /* تأثير بلور */
    z-index: -1;
}




.container {
    max-width: 1000px;
    margin: auto;
    padding: 30px;
    background-color:rgba(255, 255, 255, 0.5);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    border-radius: 12px;
    overflow: hidden;
    transition: transform 0.3s ease-in-out;
}

.container:hover {
    transform: translateY(-5px);
}

.details, .files, .videos, .texts {
    margin-bottom: 30px;
    font-size: 1.2rem;
    color: #2c3e50; /* أصفر */
    text-shadow: 
        -1px -1px 0 white,  
         1px -1px 0 white,  
        -1px  1px 0 white,  
         1px  1px 0 white,
        -1px  0px 0 white,  
         1px  0px 0 white,  
         0px -1px 0 white,  
         0px  1px 0 white;
}

.error {
    color: red;
    font-size: 1.2rem;
    text-align: center;
}

.image {
    width: 35%;
    height: auto;
    margin-top: 15px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.video-container {
    margin-top: 20px;
}

.video-container video {
    width: 35%;
    height: auto;
    border-radius: 8px;
    background-color: #000;
}

.file-section-title {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 15px;
    color: #2c3e50; /* أصفر */
    text-align: center;
    text-shadow: 
        -1px -1px 0 white,  
         1px -1px 0 white,  
        -1px  1px 0 white,  
         1px  1px 0 white,
        -1px  0px 0 white,  
         1px  0px 0 white,  
         0px -1px 0 white,  
         0px  1px 0 white;
}

.files, .videos {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* ترتيب 3 أعمدة */
    gap: 20px;
}

.files img, .videos video {
    width: 100%; /* جعل الصور تأخذ العرض بالكامل داخل العمود */
    height: auto;
    max-width: 100%;
    border-radius: 12px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.files img:hover, .videos video:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
}

.file-link {
    display: block;
    text-align: center;
    padding: 10px;
    background-color: #2c3e50; /* أصفر */
    color: #000; /* أسود */
    border-radius: 8px;
    text-decoration: none;
    font-weight: bold;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.file-link:hover {
    background-color: #C0A000; /* أصفر داكن */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
}

.error {
    background-color: #ffebee;
    border: 1px solid #f44336;
    color: #f44336;
    padding: 10px;
    border-radius: 8px;
    margin-top: 20px;
}

/* نافذة عرض الصورة في وضع ملء الشاشة */
.fullscreen-container {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.fullscreen-image {
    max-width: 90%;
    max-height: 90%;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(255, 255, 255, 0.3);
}

.close-btn {
    position: absolute;
    top: 20px;
    left: 30px;
    font-size: 30px;
    color: white;
    background: red;
    border: none;
    padding: 10px 15px;
    border-radius: 50%;
    cursor: pointer;
    font-weight: bold;
}
.logo {
    position: absolute;
    top: 10px;  /* جعلها في الأعلى */
    left: 10px; /* جعلها في اليسار */
    width: 100px; /* تكبير الصورة */
    height: 100px;
    border-radius: 10px;
}
        


/* ضبط الصور على الهاتف */
@media (max-width: 768px) {
    body {
        background: url('../images/Mbg.jpg') no-repeat center center fixed;
        background-size: cover;
    }

    body::before {
        position: fixed;
    }

    .container {
    width: 95%;
    padding: 15px;
    margin-top: 30px; /* إضافة هامش علوي لدفع العنصر للأسفل */
}

    .details, .files, .videos, .texts {
        font-size: 1rem;
    }

    .file-section-title {
        font-size: 1.3rem;
    }

    .image, .video-container video {
        width: 100%;
    }

    .files, .videos {
        grid-template-columns: repeat(2, 1fr); /* جعل التخطيط بعمودين فقط */
        gap: 10px;
    }

    .files img, .videos video {
        border-radius: 8px;
    }

    .file-link {
        padding: 8px;
        font-size: 0.9rem;
    }

    .logo {
        width: 70px;
        height: 70px;
    }

    .menu-btn {
        font-size: 16px;
        padding: 8px 12px;
    }

    .sidebar {
        width: 200px;
    }

    .sidebar ul li {
        padding: 12px;
    }

    .sidebar ul li a {
        font-size: 16px;
    }

    .texts {
        grid-template-columns: repeat(2, 1fr);
        font-size: 0.9rem;
    }

    .videos {
        width: 100%;
    }

    .fullscreen-image {
        max-width: 95%;
        max-height: 95%;
    }

    .close-btn {
        top: 10px;
        left: 15px;
        font-size: 24px;
        padding: 8px 12px;
    }
}

</style>

    <script>
        // استرجاع اسم الدرس من LocalStorage وعرض البيانات
        function getLessonData() {
            const lessonName = localStorage.getItem("lessonName");

            if (lessonName) {
                fetch('../php/get_data.php?lesson=' + lessonName)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // عرض التفاصيل
                            document.getElementById("details").innerText = "التفاصيل: " + data.details;

                            // عرض الصور
                            let filesHtml = '';
                            let videoHtml = '';
                            let textHtml = '';
                            data.files.split(',').forEach(file => {
                                file = file.trim();
                                let filePath = '../uploads/' + file.replace(/^uploads\//, '').replace(/\s+/g, '%20');
                                
                                // التحقق إذا كان الملف صورة أو فيديو أو نص
                                if (file.match(/\.(jpg|jpeg|png|gif)$/i)) {
                                    // إذا كان صورة
                                    filesHtml += `<img src="${filePath}" class="image" alt="صورة الدرس" />`;
                                } else if (file.match(/\.(mp4|avi|mov)$/i)) {
                                    // إذا كان فيديو
                                    videoHtml += `<div class="video-container"><video class="video" controls><source src="${filePath}" type="video/mp4">متصفحك لا يدعم الفيديو.</video></div>`;
                                } else if (file.match(/\.(txt|pdf|docx|xlsx|pptx|odt)$/i)) {
                                    // إذا كان ملف نصي بأنواع مختلفة
                                    textHtml += `<a href="${filePath}" class="file-link" target="_blank"> ${file}</a>`;
                                }
                            });
                            document.getElementById("images").innerHTML = filesHtml;
                            document.getElementById("videos").innerHTML = videoHtml;
                            document.getElementById("texts").innerHTML = textHtml;

                        } else {
                            document.getElementById("error").innerText = "لم يتم العثور على بيانات لهذا الدرس.";
                        }
                    })
                    .catch(error => console.error('Error:', error));
            } else {
                document.getElementById("error").innerText = "لا يوجد درس مخزن في LocalStorage.";
            }
        }

        // تنفيذ الدالة عند تحميل الصفحة
        window.onload = getLessonData;

        
function openFullscreen(src) {
    const fullscreenContainer = document.getElementById("fullscreenContainer");
    const fullscreenImage = document.getElementById("fullscreenImage");

    fullscreenImage.src = src;
    fullscreenContainer.style.display = "flex";
}

function closeFullscreen() {
    document.getElementById("fullscreenContainer").style.display = "none";
}

// تطبيق الحدث على جميع الصور عند تحميل البيانات
document.addEventListener("DOMContentLoaded", function () {
    setTimeout(() => {
        document.querySelectorAll(".image").forEach(img => {
            img.addEventListener("click", function () {
                openFullscreen(this.src);
            });
        });
    }, 500);
});

        




    </script>
    <script>
        function toggleMenu() {
    let sidebar = document.getElementById("sidebar");
    sidebar.classList.toggle("active");
}
        </script>
</head>
<body>
    
    <img src="../images/logo.jpg" alt="شعار منصة ابن مندور" class="logo">

<div class="fullscreen-container" id="fullscreenContainer">
    <button class="close-btn" onclick="closeFullscreen()">X</button>
    <img id="fullscreenImage" class="fullscreen-image" src="" alt="عرض الصورة">
</div>
<button class="menu-btn" onclick="toggleMenu()">
        <i class="fas fa-bars"></i>
      </button>

<div class="sidebar" id="sidebar">
    <ul>
        <li><a href="../index.html"><i class="fas fa-sign-out-alt"></i> تسجيل خروج</a></li>
        <li><a href="student_home.html"><i class="fas fa-house"></i> الرئيسية</a></li>
        <li><a href="show_lessons_fr_student.html"><i class="fas fa-book-open"></i> عرض الحصص</a></li>
        <li><a href="examm.html"><i class="fas fa-file-pen"></i>  الدخول للامتحان</a></li>
        <li><a href="tasks.html"><i class="fas fa-tasks"></i> قائمة المهام</a></li>


    </ul>
</div>

    <div class="container">
        
        <div class="details" id="details"></div>
        
        <!-- قسم الصور -->
        <div class="file-section-title">الصور</div>
        <div class="files" id="images"></div>
        
        <!-- قسم الفيديوهات -->
        <div class="file-section-title">الفيديوهات</div>
        <div class="videos" id="videos"></div>

        <!-- قسم الملفات النصية -->
        <div class="file-section-title">الملفات النصية</div>
        <div class="texts" id="texts"></div>
        
        <!-- رسالة خطأ -->
        <div class="error" id="error"></div>
    </div>
</body>
</html>
